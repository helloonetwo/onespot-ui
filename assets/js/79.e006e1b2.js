(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{1117:function(t,e,i){"use strict";i.r(e);i(20);var a={name:"excelUpload",data:function(){return{active:0,stepData:[{id:1,title:"上传文件",slotName:"first",btnArr:[{btnTitle:"下一步",fn:this.next}]},{id:2,title:"核对信息",slotName:"second",btnArr:[{btnTitle:"上一步",fn:this.stepBack},{btnTitle:"下一步",fn:this.submitBtn}]},{id:3,title:"完成"}],lastBtnTitle:"完成",successTitle:"发票导入完成...",fileName:"",importRecNum:0,tableData:[],tableHeader:[]}},created:function(){},methods:{beforeUpload:function(t){return this.fileName=t.name,t.size/1024/1024<1||(this.$message({message:"请不要上传大于1m的文件.",type:"warning"}),!1)},handleSuccess:function(t){var e=t.results,i=t.header;this.importRecNum=e.length,this.tableData=e,this.tableHeader=i},submitBtn:function(t){this.active+=2,this.fileName=""},next:function(){if(!this.fileName)return this.$message({message:"请先上传文件.",type:"warning"}),!1;this.active+=1},stepBack:function(){this.active-=1},complete:function(){this.active=0},downloadTemplate:function(){console.log("下载模板")}}},s=i(8),n=Object(s.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"excel-upload",staticStyle:{width:"100%"}},[e("t-layout",{attrs:{sectionTitle:"Excel上传组件"}},[e("t-step-wizard",{staticStyle:{"min-height":"400px"},attrs:{stepData:t.stepData,lastBtnTitle:t.lastBtnTitle,active:t.active,successTitle:t.successTitle},on:{complete:t.complete},scopedSlots:t._u([{key:"first",fn:function(){return[e("div",{staticClass:"content-main"},[e("t-upload-excel",{attrs:{"on-success":t.handleSuccess,"before-upload":t.beforeUpload,selectedFileText:t.fileName}}),t._v(" "),e("div",{staticClass:"hint t-margin-top-10"},[e("i",{staticClass:"i-icon icon iconfont icon-prompt t-padding5 text-primary"}),t._v(" \n            "),e("b",[t._v("提示：")]),t._v(" "),e("span",{staticClass:"text-muted"},[t._v("\n              1、如果您还没有导入模板，请点击\n              "),e("a",{on:{click:t.downloadTemplate}},[t._v("发票导入模板下载.xlsx")])]),t._v(" "),e("br"),t._v(" "),e("span",{staticClass:"text-muted",staticStyle:{"margin-left":"76px"}},[t._v("2、相同的发票不能重复上传，若已上传的数据不正确，请先删除，再重新上传。(发票号码和发票代码相同的为同一张发票)")])])],1)]},proxy:!0},{key:"second",fn:function(){return[e("div",{staticClass:"content-main"},[e("div",{staticClass:"alert-content"},[e("div",{staticClass:"alert alert-info text-center"},[e("i",{staticClass:"i-icon icon iconfont icon-prompt t-padding5 text-primary"}),t._v(" \n              "),e("span",[t._v("\n                您本次共导入\n                "),e("span",{staticClass:"text-danger"},[t._v(t._s(t.importRecNum))]),t._v("条记录\n              ")])])]),t._v(" "),e("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,border:"","highlight-current-row":""}},t._l(t.tableHeader,(function(t){return e("el-table-column",{key:t,attrs:{prop:t,label:t,"show-overflow-tooltip":"","min-width":"220",align:"center"}})})),1)],1)]},proxy:!0}])})],1)],1)}),[],!1,null,null,null);e.default=n.exports}}]);